<!DOCTYPE html>
<html>
  <head>
    <title>Prius Spotting II: Rise of the Conjugates (Rated R) – Silas B. Tittes – Adventures in genomics, evolutionary biology, and data science</title>

        <meta charset="utf-8" />
    <meta content='text/html; charset=utf-8' http-equiv='Content-Type'>
    <meta http-equiv='X-UA-Compatible' content='IE=edge'>
    <meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1.0'>

    
    <meta name="description" content="The positive response from social media made me want to do a follow-up post (thanks!), I’m gonna try to keep it short. If you haven’t read the previous post, you can do so here.

" />
    <meta property="og:description" content="The positive response from social media made me want to do a follow-up post (thanks!), I’m gonna try to keep it short. If you haven’t read the previous post, you can do so here.

" />
    
    <meta name="author" content="Silas B. Tittes" />

    
    <meta property="og:title" content="Prius Spotting II: Rise of the Conjugates (Rated R)" />
    <meta property="twitter:title" content="Prius Spotting II: Rise of the Conjugates (Rated R)" />
    


    <!--[if lt IE 9]>
      <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <link rel="stylesheet" type="text/css" href="/style.css" />
    <link rel="alternate" type="application/rss+xml" title="Silas B. Tittes - Adventures in genomics, evolutionary biology, and data science" href="/feed.xml" />

    <!-- Created with Jekyll Now - http://github.com/barryclark/jekyll-now -->
  </head>

  <body>
    <div class="wrapper-masthead">
      <div class="container">
        <header class="masthead clearfix">
          <a href="/" class="site-avatar"><img src="https://raw.githubusercontent.com/silastittes/silastittes.github.io/master/images/sims_plot.jpeg" /></a>	
	  
	  <div class="site-info">
            <h1 class="site-name"><a href="/">Silas B. Tittes</a></h1>
            <p class="site-description">Adventures in genomics, evolutionary biology, and data science</p>
          </div>

          <nav>
            <a href="/">Blog</a>
            <a href="/about">About</a>
          </nav>
        </header>
      </div>
    </div>

    <div id="main" role="main" class="container">
      <article class="post">
  <h1>Prius Spotting II: Rise of the Conjugates (Rated R)</h1>

  <div class="entry">
    <p>The positive response from social media made me want to do a follow-up post (thanks!), I’m gonna try to keep it short. If you haven’t read the previous post, you can do so <a href="https://silastittes.github.io/Prius/">here</a>.</p>

<p>After a little reading and staring at tables, I realized getting the exact solution for the posterior of the exponential rate parameter is pretty straightforward. There is certainly some value in comparing the exact solution and approximate one we arrived at in the last post using HMCMC sampling in Stan (nothing saves CPU time like math).</p>

<p>The key is conjugacy. Without going into the details, it’s often the case that the product of the likelihood and prior distributions result in a posterior distribution that is from the same family as the prior. <a href="https://en.wikipedia.org/wiki/Conjugate_prior">Wikipedia</a> has more details and a good table of conjugate distributions. The result is the ability to use data to update the parameters of the prior directly to arrive at the exact posterior.</p>

<p>The conjugate prior for the exponential distribution is the gamma distribution, where the prior values for the shape ($\alpha$) and rate ($\beta$) are updated with data as</p>

<p><script type="math/tex">\alpha' = \alpha + n</script>
and</p>

<p><script type="math/tex">\beta' = \frac{1 + \beta \sum_{i=1}^{n} y_i}{\beta}</script>
where $y_i$ are the observations and $n$ is the number of observations.</p>

<p>Side note, this is not what is listed for $\beta’$ on the Wikipedia page, I took the equation from this <a href="https://www.johndcook.com/CompendiumOfConjugatePriors.pdf">page</a>.</p>

<p>Okay, with conjugacy in hand, we can plug in some data and characterize the gamma distributed posterior of the exponential rate parameter. To make my life easier, I’m gonna keep things in terms of the rate instead of the scale (for both gamma and exponential).</p>

<p>Here’s a function to compute the exact posterior:</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="n">exp_exact</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="k">function</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">shape</span><span class="p">,</span><span class="w"> </span><span class="n">rate</span><span class="p">){</span><span class="w">
  </span><span class="n">dgamma</span><span class="p">(</span><span class="w">
    </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">xseq</span><span class="p">,</span><span class="w">
    </span><span class="n">shape</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">shape</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">length</span><span class="p">(</span><span class="n">y</span><span class="p">),</span><span class="w">
    </span><span class="n">rate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="m">1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">rate</span><span class="o">*</span><span class="nf">sum</span><span class="p">(</span><span class="n">y</span><span class="p">))</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">rate</span><span class="w">
    </span><span class="p">)</span><span class="w">
</span><span class="p">}</span><span class="w">

</span><span class="n">xseq</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">seq</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">length.out</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1000</span><span class="p">)</span><span class="w">
</span><span class="n">post_y</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">exp_exact</span><span class="p">(</span><span class="w">
  </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">xseq</span><span class="p">,</span><span class="w"> 
  </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">wt_times</span><span class="o">$</span><span class="n">wait</span><span class="p">,</span><span class="w"> 
  </span><span class="n">shape</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w">
  </span><span class="n">rate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="w">
</span><span class="p">)</span><span class="w">
</span></code></pre>
</div>

<p>Let’s visually compare the approximate and exact posteriors:</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="n">post_y</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">exp_exact</span><span class="p">(</span><span class="w">
  </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">xseq</span><span class="p">,</span><span class="w"> 
  </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">wt_times</span><span class="o">$</span><span class="n">wait</span><span class="p">,</span><span class="w"> </span><span class="c1">#&lt;-- hey there's the data!
</span><span class="w">  </span><span class="n">shape</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w">
  </span><span class="n">rate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="w">
</span><span class="p">)</span><span class="w">

</span><span class="n">plot</span><span class="p">(</span><span class="n">density</span><span class="p">(</span><span class="n">exp_post</span><span class="o">$</span><span class="n">beta</span><span class="p">),</span><span class="w">
     </span><span class="n">main</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w"> 
     </span><span class="n">xlab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Rate parameter"</span><span class="p">)</span><span class="w">
</span><span class="n">lines</span><span class="p">(</span><span class="n">xseq</span><span class="p">,</span><span class="w"> </span><span class="n">post_y</span><span class="p">,</span><span class="w"> </span><span class="n">col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"blue"</span><span class="p">,</span><span class="w"> </span><span class="n">lty</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">3</span><span class="p">,</span><span class="w"> </span><span class="n">lwd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="p">)</span><span class="w">

</span><span class="n">legend</span><span class="p">(</span><span class="s2">"topright"</span><span class="p">,</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"approximate"</span><span class="p">,</span><span class="w"> </span><span class="s2">"exact"</span><span class="p">),</span><span class="w"> </span><span class="n">lty</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">3</span><span class="p">))</span><span class="w">
</span></code></pre>
</div>

<p><img src="/figure/source/2017-09-03-Prius2/unnamed-chunk-3-1.png" title="plot of chunk unnamed-chunk-3" alt="plot of chunk unnamed-chunk-3" style="display: block; margin: auto;" />
Not surprisingly, quite close! If we ran Stan multiple times, I’m sure it would nicely hug the exact curve. We can better evaluate just how close things are by comparing the approximate parameter values produced by Stan to those produced using math. To do so, we have to use a little trick called moment matching, where we can use the mean and variance (the first and second moments) of Stan’s draws to derive $\alpha$ and $\beta$ values for the gamma distribution. Relying on Wikipedia (or pretty much any book on Probability), we find:</p>

<p><script type="math/tex">\mu = \frac{\alpha}{\beta}</script> 
and</p>

<p><script type="math/tex">\sigma^2 = \frac{\alpha}{\beta^}</script>
We could either use the parameters for the exact gamma, and get the moments, or use the moments of the Stan draws, and convert to the gamma parameters. For a number of reasons, its’ useful to demonstrate the latter. From the system of two equations, we can solve the two parameters as functions of the moments:</p>

<p><script type="math/tex">\alpha = \frac{\mu^2}{\sigma^2}</script>
and
<script type="math/tex">\beta = \frac{\mu^2}{\sigma^2}</script>
Now, we can plug this into R and see how the three curve compare numerically and visually:</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="n">post_y</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">exp_exact</span><span class="p">(</span><span class="w">
  </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">xseq</span><span class="p">,</span><span class="w"> 
  </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">wt_times</span><span class="o">$</span><span class="n">wait</span><span class="p">,</span><span class="w"> </span><span class="c1">#&lt;-- hey there's the data!
</span><span class="w">  </span><span class="n">shape</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w">
  </span><span class="n">rate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="w">
</span><span class="p">)</span><span class="w">

</span><span class="n">prox_y</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">dgamma</span><span class="p">(</span><span class="w">
  </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">xseq</span><span class="p">,</span><span class="w"> 
  </span><span class="n">shape</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mean</span><span class="p">(</span><span class="n">exp_post</span><span class="o">$</span><span class="n">beta</span><span class="p">)</span><span class="o">^</span><span class="m">2</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">var</span><span class="p">(</span><span class="n">exp_post</span><span class="o">$</span><span class="n">beta</span><span class="p">),</span><span class="w">
  </span><span class="n">rate</span><span class="w"> </span><span class="o">=</span><span class="w">  </span><span class="n">mean</span><span class="p">(</span><span class="n">exp_post</span><span class="o">$</span><span class="n">beta</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">var</span><span class="p">(</span><span class="n">exp_post</span><span class="o">$</span><span class="n">beta</span><span class="p">)</span><span class="w">
  </span><span class="p">)</span><span class="w">


</span><span class="n">plot</span><span class="p">(</span><span class="n">density</span><span class="p">(</span><span class="n">exp_post</span><span class="o">$</span><span class="n">beta</span><span class="p">),</span><span class="w">
     </span><span class="n">main</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w"> 
     </span><span class="n">xlab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Rate parameter"</span><span class="p">)</span><span class="w">
</span><span class="n">lines</span><span class="p">(</span><span class="n">xseq</span><span class="p">,</span><span class="w"> </span><span class="n">post_y</span><span class="p">,</span><span class="w"> </span><span class="n">col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"blue"</span><span class="p">,</span><span class="w"> </span><span class="n">lty</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">3</span><span class="p">,</span><span class="w"> </span><span class="n">lwd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="p">)</span><span class="w">
</span><span class="n">lines</span><span class="p">(</span><span class="n">xseq</span><span class="p">,</span><span class="w"> </span><span class="n">prox_y</span><span class="p">,</span><span class="w"> </span><span class="n">col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"red"</span><span class="p">,</span><span class="w"> </span><span class="n">lty</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">3</span><span class="p">,</span><span class="w"> </span><span class="n">lwd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="p">)</span><span class="w">


</span><span class="n">legend</span><span class="p">(</span><span class="w">
  </span><span class="s2">"topright"</span><span class="p">,</span><span class="w"> 
  </span><span class="nf">c</span><span class="p">(</span><span class="s2">"approximate"</span><span class="p">,</span><span class="w"> </span><span class="s2">"exact"</span><span class="p">,</span><span class="w"> </span><span class="s2">"approx. to gamma"</span><span class="p">),</span><span class="w"> 
  </span><span class="n">lty</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">3</span><span class="p">,</span><span class="w"> </span><span class="m">3</span><span class="p">),</span><span class="w"> 
  </span><span class="n">col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"black"</span><span class="p">,</span><span class="w"> </span><span class="s2">"blue"</span><span class="p">,</span><span class="w"> </span><span class="s2">"red"</span><span class="p">)</span><span class="w">
  </span><span class="p">)</span><span class="w">
</span></code></pre>
</div>

<p><img src="/figure/source/2017-09-03-Prius2/unnamed-chunk-4-1.png" title="plot of chunk unnamed-chunk-4" alt="plot of chunk unnamed-chunk-4" style="display: block; margin: auto;" /></p>

<p>For the exact gamma, $\alpha = $ 18 and $\beta = $ 618, for the Stan draws, $\alpha = $ 19.15, and $\beta = $ 655.5. The Stan results are not identical, but running the model several times, the numbers generally are quite close.</p>

<p>As mentioned in the last post, it’s only the simplest models that we can get exact solutions for the posterior, but why not do it when you can?</p>

<p>Before ending the post, let’s also look at the effect of varying the prior values.</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="n">n_sim</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">10</span><span class="w">

</span><span class="n">xseq</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">seq</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">0.25</span><span class="p">,</span><span class="w"> </span><span class="n">length.out</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">500</span><span class="p">)</span><span class="w">

</span><span class="n">shapes</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">seq</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">100</span><span class="p">,</span><span class="w"> </span><span class="n">length.out</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1000</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="n">sample</span><span class="p">(</span><span class="m">10</span><span class="p">)</span><span class="w"> 
</span><span class="n">rates</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">seq</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">100</span><span class="p">,</span><span class="w"> </span><span class="n">length.out</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1000</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="n">sample</span><span class="p">(</span><span class="m">10</span><span class="p">)</span><span class="w">

</span><span class="n">prior_df</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">1</span><span class="o">:</span><span class="n">n_sim</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="n">map_df</span><span class="p">(</span><span class="o">~</span><span class="p">{</span><span class="w">
  </span><span class="n">post_y</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">exp_exact</span><span class="p">(</span><span class="w">
  </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">xseq</span><span class="p">,</span><span class="w"> 
  </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">wt_times</span><span class="o">$</span><span class="n">wait</span><span class="p">,</span><span class="w"> 
  </span><span class="n">shape</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">shapes</span><span class="p">[</span><span class="n">.x</span><span class="p">],</span><span class="w">
  </span><span class="n">rate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rates</span><span class="p">[</span><span class="n">.x</span><span class="p">]</span><span class="w">
  </span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="n">data.frame</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">mutate</span><span class="p">(</span><span class="n">sim</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">rep</span><span class="p">(</span><span class="n">.x</span><span class="p">,</span><span class="w"> </span><span class="nf">length</span><span class="p">(</span><span class="n">xseq</span><span class="p">)),</span><span class="w">
         </span><span class="n">xseq</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">xseq</span><span class="p">)</span><span class="w">
</span><span class="p">})</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="n">set_colnames</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="s2">"prob"</span><span class="p">,</span><span class="w"> </span><span class="s2">"iter"</span><span class="p">,</span><span class="w"> </span><span class="s2">"xseq"</span><span class="p">))</span><span class="w">


</span><span class="n">obs_den</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">density</span><span class="p">(</span><span class="n">exp_post</span><span class="o">$</span><span class="n">beta</span><span class="p">)</span><span class="w">
</span><span class="n">obs_df</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">data.frame</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">obs_den</span><span class="o">$</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">obs_den</span><span class="o">$</span><span class="n">y</span><span class="p">)</span><span class="w">

</span><span class="n">ggplot</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">geom_line</span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">prior_df</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">xseq</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">prob</span><span class="p">,</span><span class="w"> </span><span class="n">group</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iter</span><span class="p">),</span><span class="w"> </span><span class="n">colour</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"blue"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">geom_line</span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">obs_df</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">y</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">xlab</span><span class="p">(</span><span class="s2">"Rate"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">ylab</span><span class="p">(</span><span class="s2">"Density"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">theme_minimal</span><span class="p">()</span><span class="w">
</span></code></pre>
</div>

<p><img src="/figure/source/2017-09-03-Prius2/unnamed-chunk-5-1.png" title="plot of chunk unnamed-chunk-5" alt="plot of chunk unnamed-chunk-5" style="display: block; margin: auto;" /></p>

<p>After trying a lot of different values, I can’t seem to produce a posterior with a rate much lower than the original. I suppose that indicates the priors I chose were regularizing by placing weight on slower rates. Now, some of the posteriors shown here are absurd (i.e. a rate of 0.15 is a Prius every ~6.5 seconds), so clearly the data is somewhat more sensitive to the prior choices than I previously suggested, but it’s also worth noting that I’m haphazardly considering some ridiculously large priors.</p>

<p>I’ll end the post by commenting on another exciting thing about Bayesian approaches, and that’s updating. Besides getting some new data, this and the last post have already introduced all the ingredients we need to produce another posterior. The new posterior would use the previous posterior to derive the priors. Even if our choice in priors sucks the first go round, we can utilize our old data in an elegant and direct way through new priors that should be better informed about what we ought to expect to see in the world. But, I’ll leave that for the next post, part III of the series. Expect another cheesy name too.</p>

<p>Along with the internet, this post was greatly aided by having read Hobbs and Hooten’s excellent and concise text, <em>Bayesian models: a statistical primer for ecologists</em>.</p>

  </div>

  <div class="date">
    Written on September  3, 2017
  </div>

  
<div class="comments">
	<div id="disqus_thread"></div>
	<script type="text/javascript">

	    var disqus_shortname = 'silastittes';

	    (function() {
	        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
	        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
	        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
	    })();

	</script>
	<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>

</article>



    </div>

    <div class="wrapper-footer">
	    <div class="container">
			  <footer class="footer">
			  <center><dev align="center"><a href="https://scholar.google.com/citations?user=LxGAurUAAAAJ&hl=en"><img border="0" alt="Google Scholar" src="https://raw.githubusercontent.com/silastittes/silastittes.github.io/master/images/google_scholar_wCap.png" width="150" height="200"></a><a href="https://www.inaturalist.org/projects/the-sunflower-community-project"><img border="0" alt="iNaturalist" src="https://raw.githubusercontent.com/silastittes/silastittes.github.io/master/images/Nat_bird.png" width="251" height="200"><a href="http://nkane.weebly.com/"><img border="0" alt="Kane lab" src="https://raw.githubusercontent.com/silastittes/silastittes.github.io/master/images/kane_lab.png" width="215" height="215"></a></a></dev></center>
			  </footer>
		  </div>
	  </div>
<!--
    <div class="wrapper-footer">
      <div class="container">
        <footer class="footer">
          
<a href="mailto:silas.tittes@gmail.com"><i class="svg-icon email"></i></a>


<a href="https://github.com/silastittes"><i class="svg-icon github"></i></a>




<a href="https://www.twitter.com/SilasTittes"><i class="svg-icon twitter"></i></a>



        </footer>
      </div>
    </div>
-->
    



  </body>
</html>

<p>Since my last post, I’ve learned about the option to add figure captions to plots (figure 1) in Rmarkdown – fancy! I also realized one reason why the frequency of phenotypic classes didn’t seem more similar to the densities taken from the normal distribution with the same parameters. Here’s where I left off (typos and all):</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="n">plot</span><span class="p">(</span><span class="n">out</span><span class="o">$</span><span class="n">class.types</span><span class="p">,</span><span class="w"> </span><span class="n">out</span><span class="o">$</span><span class="n">class.freqs</span><span class="p">,</span><span class="w"> 
    </span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"h"</span><span class="p">,</span><span class="w"> </span><span class="n">lwd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">3</span><span class="p">,</span><span class="w"> </span><span class="n">ylab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Frequency of phenotypic class"</span><span class="p">,</span><span class="w"> 
    </span><span class="n">xlab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Phenotypic classes"</span><span class="p">)</span><span class="w">

</span><span class="c1"># See what a normal
# distribution looks like on
# top of the
</span><span class="n">avg</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">sum</span><span class="p">(</span><span class="n">out</span><span class="o">$</span><span class="n">class.types</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">out</span><span class="o">$</span><span class="n">class.freqs</span><span class="p">)</span><span class="w">
</span><span class="n">stdev</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">sqrt</span><span class="p">(</span><span class="nf">sum</span><span class="p">(((</span><span class="n">out</span><span class="o">$</span><span class="n">class.types</span><span class="w"> </span><span class="o">-</span><span class="w"> 
    </span><span class="n">avg</span><span class="p">)</span><span class="o">^</span><span class="m">2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">out</span><span class="o">$</span><span class="n">class.freqs</span><span class="p">)))</span><span class="w">
</span><span class="n">den.theor</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">dnorm</span><span class="p">(</span><span class="n">out</span><span class="o">$</span><span class="n">class.types</span><span class="p">,</span><span class="w"> 
    </span><span class="n">mean</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">avg</span><span class="p">,</span><span class="w"> </span><span class="n">sd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">stdev</span><span class="p">)</span><span class="w">
</span><span class="n">lines</span><span class="p">(</span><span class="n">out</span><span class="o">$</span><span class="n">class.types</span><span class="p">,</span><span class="w"> </span><span class="n">den.theor</span><span class="p">,</span><span class="w"> 
    </span><span class="n">col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"red"</span><span class="p">,</span><span class="w"> </span><span class="n">lwd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">6</span><span class="p">)</span><span class="w">
</span></code></pre>
</div>

<p><img src="/figure/./AdditiveAlleles_Addendum/unnamed-chunk-3-1.png" alt="A trip down memory lane (my last post). The distribution of phenotypic classes that result from the additive contrubutions of 100 loci. The red line shows the density from normal distribution with the same mean and standard deviation as the data." /></p>

<p>My realization came from plotting the density values from the normal distribution with the parameters from the data against the actual frequencies (figure 2) – like so:</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="n">plot</span><span class="p">(</span><span class="n">den.theor</span><span class="p">,</span><span class="w"> </span><span class="n">out</span><span class="o">$</span><span class="n">class.freqs</span><span class="p">,</span><span class="w"> 
    </span><span class="n">pch</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">19</span><span class="p">)</span><span class="w">
</span><span class="n">abline</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">lwd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"red"</span><span class="p">)</span><span class="w">
</span></code></pre>
</div>

<p><img src="/figure/./AdditiveAlleles_Addendum/unnamed-chunk-4-1.png" alt="Density of normal distribution with mean and standard deviation taken from the phenotypic classes, against the acutal frequency of the phenotypic classes. Line shows 1:1 relationship I was hoping for." /></p>

<p>The cool thing is, the density and actual values seem to have a linear relationship (figure 2), but it’s just not one-to-one. Time for a regression!</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="n">mod</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">lm</span><span class="p">(</span><span class="n">out</span><span class="o">$</span><span class="n">class.freqs</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">den.theor</span><span class="p">)</span><span class="w">
</span><span class="nf">round</span><span class="p">(</span><span class="n">mod</span><span class="o">$</span><span class="n">coefficients</span><span class="p">)</span><span class="w">
</span></code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>## (Intercept)   den.theor 
##           0          19
</code></pre>
</div>

<p>After a bit of farting around, it became clear that the slope of the regression line was the difference between the allele contributions! Try it yourself if you don’t believe me. I was rather excited to learn this, and it seems to hold true for any case I try (I call this a “pudding proof” because it’s not a mathematical proof, but the proof is in there somewhere – just keep eating. I also like pudding quite a bit).</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="n">n.loci</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">100</span><span class="w">  </span><span class="c1">#choose the number of loci
</span><span class="n">allele.types</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">10</span><span class="p">,</span><span class="w"> </span><span class="m">5</span><span class="p">)</span><span class="w">  </span><span class="c1">#choose the allelic contributions
</span><span class="n">allele.diff</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">abs</span><span class="p">(</span><span class="n">allele.types</span><span class="p">[</span><span class="m">2</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> 
    </span><span class="n">allele.types</span><span class="p">[</span><span class="m">1</span><span class="p">])</span><span class="w">
</span><span class="n">out</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">pheno.dist</span><span class="p">(</span><span class="n">n.loci</span><span class="p">,</span><span class="w"> </span><span class="n">allele.types</span><span class="p">)</span><span class="w">

</span><span class="c1"># plot
</span><span class="n">plot</span><span class="p">(</span><span class="n">out</span><span class="o">$</span><span class="n">class.types</span><span class="p">,</span><span class="w"> </span><span class="n">out</span><span class="o">$</span><span class="n">class.freqs</span><span class="p">,</span><span class="w"> 
    </span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"h"</span><span class="p">,</span><span class="w"> </span><span class="n">lwd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">3</span><span class="p">,</span><span class="w"> </span><span class="n">col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"grey50"</span><span class="p">,</span><span class="w"> 
    </span><span class="n">ylab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Frequency of phenotypic class"</span><span class="p">,</span><span class="w"> 
    </span><span class="n">xlab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Phenotypic classes"</span><span class="p">)</span><span class="w">

</span><span class="c1"># See what a normal
# distribution looks like on
# top of the data
</span><span class="n">avg</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">sum</span><span class="p">(</span><span class="n">out</span><span class="o">$</span><span class="n">class.types</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">out</span><span class="o">$</span><span class="n">class.freqs</span><span class="p">)</span><span class="w">
</span><span class="n">stdev</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">sqrt</span><span class="p">(</span><span class="nf">sum</span><span class="p">(((</span><span class="n">out</span><span class="o">$</span><span class="n">class.types</span><span class="w"> </span><span class="o">-</span><span class="w"> 
    </span><span class="n">avg</span><span class="p">)</span><span class="o">^</span><span class="m">2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">out</span><span class="o">$</span><span class="n">class.freqs</span><span class="p">)))</span><span class="w">
</span><span class="n">den.theor</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">dnorm</span><span class="p">(</span><span class="n">out</span><span class="o">$</span><span class="n">class.types</span><span class="p">,</span><span class="w"> 
    </span><span class="n">mean</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">avg</span><span class="p">,</span><span class="w"> </span><span class="n">sd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">stdev</span><span class="p">)</span><span class="w">
</span><span class="n">mod</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">lm</span><span class="p">(</span><span class="n">out</span><span class="o">$</span><span class="n">class.freqs</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">den.theor</span><span class="p">)</span><span class="w">

</span><span class="n">scaler</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">allele.types</span><span class="p">[</span><span class="m">1</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">allele.types</span><span class="p">[</span><span class="m">2</span><span class="p">]</span><span class="w">
</span><span class="n">lines</span><span class="p">(</span><span class="n">out</span><span class="o">$</span><span class="n">class.types</span><span class="p">,</span><span class="w"> </span><span class="n">den.theor</span><span class="w"> </span><span class="o">*</span><span class="w"> 
    </span><span class="n">scaler</span><span class="p">,</span><span class="w"> </span><span class="n">col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"red"</span><span class="p">,</span><span class="w"> </span><span class="n">lwd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">6</span><span class="p">)</span><span class="w">
</span></code></pre>
</div>

<p><img src="/figure/./AdditiveAlleles_Addendum/unnamed-chunk-7-1.png" alt="A new lane for new memories. The distribution of phenotypic classes that result from the additive contrubutions of 100 loci. The red line shows the density from normal distribution with the same mean and standard deviation as the data." /></p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="n">plot</span><span class="p">(</span><span class="n">den.theor</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">scaler</span><span class="p">,</span><span class="w"> </span><span class="n">out</span><span class="o">$</span><span class="n">class.freqs</span><span class="p">,</span><span class="w"> 
    </span><span class="n">pch</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">19</span><span class="p">)</span><span class="w">
</span><span class="n">abline</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">lwd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"red"</span><span class="p">)</span><span class="w">
</span></code></pre>
</div>

<p><img src="/figure/./AdditiveAlleles_Addendum/unnamed-chunk-8-1.png" alt="Density of normal distribution with mean and standard deviation taken from the phenotypic classes, against the actual frequency of the phenotypic classes. Line shows 1:1 relationship I was hoping for." /></p>

<p>This looks mighty similar, but the plot thickens when we look at the residuals (figure 5)!</p>

<div class="language-r highlighter-rouge"><pre class="highlight"><code><span class="n">plot</span><span class="p">(</span><span class="n">out</span><span class="o">$</span><span class="n">class.freqs</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">den.theor</span><span class="w"> </span><span class="o">*</span><span class="w"> 
    </span><span class="n">scaler</span><span class="p">,</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"b"</span><span class="p">,</span><span class="w"> </span><span class="n">cex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.3</span><span class="p">,</span><span class="w"> 
    </span><span class="n">ylab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"class freqs. - (density of normal * (Allele1 - Allele2))"</span><span class="p">)</span><span class="w">
</span></code></pre>
</div>

<p><img src="/figure/./AdditiveAlleles_Addendum/unnamed-chunk-9-1.png" alt="Difference between scaled density and the frequency  phenotypic classes. Something funny is going on near the mean" /></p>

<p>I haven’t spent very long thinking why scaling the density by the difference in allele values makes them more closely match the phenotypic classes, or why the phenotypic classes aren’t quite normal. If you have any thoughts, email me! My attempt at an addendum has solved one question and made several new ones. I suppose I have heard that the distribution of phenotypic classes that results from the contribution of multiple additive alleles is <em>approximated</em> by the normal distribution. 
As I’ll explore in another post, the term approximate becomes more important as the contributions from each allele begin to differ.</p>

<p>As with most things, if I spent a little time reading, I could probably find the exact form of the mean and variance, but it wouldn’t be nearly as fun as struggling through it on my own. Perhaps a second addendum at a future data is in order. Toddler steps.</p>
